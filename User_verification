import smtplib
import random as r

    
def sign_up():
    print("Welcome. PLease sign up with your email.")
    username = input("Please enter your email:")
    password = input("PLease enter a password:")
    
    return username, password


def verify(email):
    try: 
        smtp = smtplib.SMTP('smtp.gmail.com', 587) 
        smtp.starttls() 
        smtp.login("testparkd4@gmail.com","tess4tess4")
        
        verification_code = r.randint(100000,999999)
        message = "Hi, \nThis is a verfication email from ParKd.\nYour verification code is"+ str(verification_code)
        

        smtp.sendmail("testparkd4@gmail.com", email, message) 
        smtp.quit() 
        
        print ("Email sent successfully!") 
        return verification_code
    
    
    except Exception as ex: 
        print("Something went wrong....",ex) 


def user_verification(var_check, username, password):
    print("Please check your email for the varification code.")
    var = int(input("Once received please input the varification code here:"))
    temp = int(var_check)
    if var == temp:
        print("User varified.")
        open("credentials.csv", 'a').write(username + ",")
        open("credentials.csv", 'a').write(password + ",")
    else:
        print("Wrong input. Try again.")
        verify(username)
    

(username, password) = sign_up()
var_check = verify(username)
user_verification(var_check, username, password)


import msvcrt as m
m.getch()
